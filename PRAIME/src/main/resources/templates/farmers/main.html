<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>농담</title>
<link th:href="@{/css/font.css}" rel="stylesheet">
<link th:href="@{/css/common.css}" rel="stylesheet">
<link th:href="@{/css/farmers/main.css}" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:src="@{/js/common.js}"></script>
<script th:src="@{/js/farmers/main.js}"></script>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
	<div class="container">
		<div class="wrapper">
			<header>
				<div class="header-group">
					<div class="header-title-group">
						<h1 th:text="${session.user.name}" class="header-title">SuperNova
							님</h1>
						<p class="header-subtitle">오늘도 좋은하루 되세요</p>
					</div>
					<div class="today-group">
						<span class="today">2025년 6월 17일</span>
					</div>
				</div>
			</header>
			<main>
				<div class="main-wrap">
					<section class="weather-section">
						<div class="weather-box">
							<div class="weather-top">
								<div class="weather-left">
									<h1 class="weather-title">오늘의 날씨</h1>
									<div class="weather-info">
										<div class="weather-icon">
											<img id="weatherIcon" src="" alt="날씨 아이콘" width="128" height="128">
										</div>
										<div class="weather-detail">
											<div class="temperature" id="temperature"></div>
											<div class="humidity" id="humidity"></div>
											<div class="rainfall" id="rainfall"></div>
											<div class="wind" id="wind"></div>
										</div>
									</div>
								</div>
								<div class="weather-right">
									<div class="weather-tasks-title">예상 특보</div>
									<div class="weather-tasks" id="weatherWarning"></div>
								</div>
							</div>

							<hr class="divider" />

							<div class="weather-bottom">
								<div class="weather-location">광주시 충장동 기준</div>
								<div class="weather-update-time" id="updateTime"></div>
							</div>
						</div>
					</section>
					
					<hr class="divider" />
					
					<section class="core-func-section">
						<div class="core-title">핵심 기능</div>
						<div class="core-card-group">
							<div class="core-card" onclick="goToFarmlogWritePage()">
								<img th:src="@{/img/log.png}" alt="작업 일지" class="core-icon">
								<span class="core-label">영농일지</span>
							</div>
							<div class="core-card" onclick="goToDiagnosisUploadPage()">
								<img th:src="@{/img/bug.png}" alt="병해충 진단" class="core-icon">
								<span class="core-label">병해충 진단</span>
							</div>
						</div>
					</section>
					
					<hr class="divider" />
					
					
					<section class="recent-journal-section">
						<div class="section-header">
							<h2 class="section-title">최근 일지</h2>
							<a href="/farmlogBoardPage" class="view-all">전체보기 &gt;</a>
						</div>

						<div class="journal-list">
							<div class="journal-item">
								<div class="journal-date">오늘</div>
								<div class="journal-content">
									<div class="journal-title">사과나무 물주기 및 유인작업</div>
									<div class="journal-desc">가지 유인 및 수분 관리 작업을 진행했습니다.</div>
								</div>
							</div>
							<div class="journal-item">
								<div class="journal-date">오늘</div>
								<div class="journal-content">
									<div class="journal-title">사과나무 물주기 및 유인작업</div>
									<div class="journal-desc">가지 유인 및 수분 관리 작업을 진행했습니다.</div>
								</div>
							</div>
							<div class="journal-item">
								<div class="journal-date">오늘</div>
								<div class="journal-content">
									<div class="journal-title">사과나무 물주기 및 유인작업</div>
									<div class="journal-desc">가지 유인 및 수분 관리 작업을 진행했습니다.</div>
								</div>
							</div>
							<div class="journal-item">
								<div class="journal-date">어제</div>
								<div class="journal-content">
									<div class="journal-title">사과나무 전정 작업</div>
									<div
										class="journal-desc">주요 가지 전정 작업과 순 제거를 했습니다.</div>
								</div>
							</div>
							<div class="journal-item">
								<div class="journal-date">06.15</div>
								<div class="journal-content">
									<div class="journal-title">사과나무 전정 작업</div>
									<div
										class="journal-desc">주요 가지 전정 작업과 순 제거를 했습니다.</div>
								</div>
							</div>
						</div>

						<div class="journal-add-button">
							<button class="add-journal-btn" onclick="goToFarmlogWritePage()">+
								새 영농일지 작성하기</button>
						</div>
					</section>
					
					<hr class="divider" />
					
					
                    <section class="recent-diagnosis-section">
                        <div class="section-header">
                            <h2 class="section-title">최근 진단 이력</h2>
                            <a href="/diagnosisBoardPage" class="view-all">전체보기 &gt;</a>
                        </div>
                    
                        <div class="journal-list">
                            <div th:if="${#lists.isEmpty(diagnosisList)}" class="no-records">
                                진단 기록이 없습니다.
                            </div>
                            <div class="journal-item" th:each="diagnosis : ${diagnosisList}">
                                <div class="journal-date" 
                                     th:text="${#temporals.format(diagnosis.createdAt, 'MM.dd').equals(#temporals.format(#temporals.createNow(), 'MM.dd'))} ? '오늘' : ${#temporals.format(diagnosis.createdAt, 'yy.MM.dd')}">
                                     </div>
                                <div class="journal-content">
                                    <div class="journal-image-thumbnail">
                                        <img th:src="@{${diagnosis.imagePath}}" th:alt="${diagnosis.label} + ' 진단 이미지'">
                                    </div>
                                    <div class="journal-text-content"> <div class="journal-title" th:text="${diagnosis.label}"></div>
                                        <div class="journal-desc">
                                            신뢰도: <span th:text="${#numbers.formatDecimal(diagnosis.confidence, 0, 'COMMA', 0, 'POINT')} + '%'"></span>
                                            <div class="card-bar" th:styleappend="'--confidence-width: ' + ${#numbers.formatDecimal(diagnosis.confidence, 0, 0)} + '%'"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                        <div class="journal-add-button">
                            <button class="add-journal-btn" onclick="goToDiagnosisUploadPage()">+ 병해충 진단 하기</button>
                        </div>
                    </section>
					
				</div>
			</main>
			<div th:replace="/global/footer::footer "></div>
		</div>
	</div>
<!-- 이미지 모달 -->	
<div id="imageModal" class="modal">
    <span class="close-button">&times;</span>
    <img class="modal-content" id="modalImage">
    <div id="modalCaption"></div>
</div>	
</body>
</html>