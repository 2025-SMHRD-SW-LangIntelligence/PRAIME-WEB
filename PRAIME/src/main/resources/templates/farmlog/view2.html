<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link th:href="@{/css/font.css}" rel="stylesheet">
<link th:href="@{/css/common.css}" rel="stylesheet">
<link th:href="@{/css/farmlog/view.css}" rel="stylesheet">

<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:src="@{/js/farmlog/view.js}"></script>

<title>영농일지 상세 페이지</title>
</head>
<!-- log 객체를 JSON 문자열로 data-log-data 속성에 전달 -->
<body th:attr="data-log-data=${log != null ? @json(log) : '{}'}">
    <!-- HEADER MOVED OUTSIDE .container FOR FULL WIDTH GREEN BACKGROUND -->
    <header>
        <div class="header-group">
            <a href="#" class="prevPage" onclick="history.back()"> &lt; </a>
            <div class="header-title-group">
                <span class="header-title">일지 상세</span>
            </div>
        </div>
    </header>

	<div class="container">
        <!-- Second Row: Weather & Date Navigation (integrated, no card-like styling) -->
<!-- info-bar 영역 -->
<div class="info-bar" th:each="log : ${logList}">
    <div class="weather-info">
        <div class="weather-info-group">
            <img src="/img/weather/sun.png" alt="날씨" class="weather-icon">
            <div class="weather-string" th:text="${log.dlweather} ?: '날씨 정보 없음'"></div>
        </div>
        <div class="weather-details">
            <div class="temperature-group">
                <img src="https://icons.iconarchive.com/icons/fatcow/farm-fresh/32/temperature-hot-icon.png" width="25" height="25">
                <span class="temperature" th:text="'기온 : ' + ${log.dltemp} + '℃'"></span>
            </div>
        </div>
    </div>

    <!-- 날짜 정보 -->
    <div class="date-info">
        <span class="year" 
              th:text="${#temporals.format(log.dldate, 'yyyy년')}">2025년</span>
        <span class="month-day-dayofweek"
              th:text="${#temporals.format(log.dldate, 'M월 d일 (E)')}">6월 24일 (화)</span>
    </div>
</div>

        <main class="detail-main">
            <!-- Entire main content is wrapped in one card -->
            <div class="main-content-card">
                <section class="basic-info-section detail-section-item">
                    <div class="info-row">
                        <p class="info-label">작물</p>
                        <p class="info-value">사과</p> </div>
                    <div class="info-row">
                        <p class="info-label">농작업</p>
                        <p class="info-value">물주기</p> </div>
                    <div class="info-row">
                        <p class="info-label">농약</p>
                        <p class="info-value">HB3000-K 50nl</p> </div>
                </section>
                <hr class="divider">

                <section class="content-section detail-section-item">
                    <h3 class="content-title">맛있는 사과를 키우기위한 100가지 방법</h3>
                    <p class="content-text">
                        12년차 사과와 미안마 올해도 3차 적과
                        끝내고 우거진 가지 치기와 여름에는 잡풀이
                        1달에 2번 이상 자동예초기로 풀을 제거 해야
                        하기에 바쁜 일상이다
                    </p>
                </section>
                <hr class="divider">

                <section class="image-section detail-section-item">
                    <div class="main-image-display">
                        <img id="main-diary-image" th:src="${not #lists.isEmpty(log.dlimage)} ? @{'/uploads/farmlog/' + ${log.dlimage[0].dlipath}} : @{/img/no-image.png}" alt="대표 일지 이미지">
                    </div>
                    <div class="thumbnail-gallery">
                        <div th:if="${not #lists.isEmpty(log.dlimage)}">
                            <img th:each="img : ${log.dlimage}"
                                th:src="@{'/uploads/farmlog/' + ${img.dlipath}}"
                                class="thumbnail-image"
                                alt="일지 썸네일 이미지"
                                th:data-full-src="@{'/uploads/farmlog/' + ${img.dlipath}}" />
                        </div>
                        <div th:if="${#lists.isEmpty(log.dlimage)}">
                            <img th:src="@{/img/no-image.png}" class="thumbnail-image default-thumbnail" alt="기본 이미지" th:data-full-src="@{/img/no-image.png}" />
                        </div>
                    </div>
                </section>
                <hr class="divider">

                <section class="button-group-section detail-section-item">
                    <div class="detail-buttons">
                        <button class="btn edit-btn"
                            th:onclick="|location.href='/farmlog/edit/${log.dlid}'|">
                            <i class="fas fa-edit"></i> 수정
                        </button>

                        <button class="btn delete-btn"
                            th:onclick="|deleteDiary(${log.dlid})|">
                            <i class="fas fa-trash-alt"></i> 삭제
                        </button>
                    </div>
                </section>
            </div> 
        </main>
        <div th:replace="/global/footer::footer "></div> 		
	</div>
</body>
</html>